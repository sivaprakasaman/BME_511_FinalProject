function [env_cohere, tfs_cohere, s, phi, input_env, input_tfs] = getCoherence(bankedSig, input_fs, psth_pos, psth_neg, psth_fs, NFFT, dur, CF);
%UNTITLED Summary of this function goes here
%   Detailed explanation goes here
    
    env_cohere = zeros(length(CF), NFFT/2+1);
    tfs_cohere = zeros(length(CF), NFFT/2+1);
    s = zeros(length(CF), dur*psth_fs);
    phi = zeros(length(CF), dur*psth_fs);
    input_env = abs(hilbert(bankedSig));
    input_tfs = cos(angle(hilbert(bankedSig)));
    
    s = (psth_pos+psth_neg)./2;
    d = (psth_pos-psth_neg)./2;
    phi = sqrt(2)*rms(d)*(d./abs(hilbert(d)));

    for i = 1:length(CF)
        
        env_cohere(i,:) = mscohere();
        tfs_cohere(i,:) = mscohere();
        
    end

end

